RESET MASTER;
FLUSH BINARY LOGS DELETE_DOMAIN_ID = ();
Only 1 log must be present
show binary logs;
Log_name	File_size
master-bin.000001	#
master-bin.000002	#
FLUSH BINARY LOGS DELETE_DOMAIN_ID = (99);
Warnings:
Warning	1982	being deleted gtid domain '99' is not in the current binlog state
SHOW WARNINGS;
Level	Code	Message
Warning	1982	being deleted gtid domain '99' is not in the current binlog state
show binary logs;
Log_name	File_size
master-bin.000001	#
master-bin.000002	#
SET @@SESSION.gtid_domain_id=1;
SET @@SESSION.server_id=1;
CREATE TABLE t (a int);
FLUSH BINARY LOGS DELETE_DOMAIN_ID = (1);
ERROR HY000: Could not delete gtid domain. Reason: binlog files may contain gtids from being deleted domain '1'; make sure first to purge those files.
FLUSH BINARY LOGS;
FLUSH BINARY LOGS DELETE_DOMAIN_ID = (1);
ERROR HY000: Could not delete gtid domain. Reason: binlog files may contain gtids from being deleted domain '1'; make sure first to purge those files.
SHOW WARNINGS;
Level	Code	Message
Error	1982	Could not delete gtid domain. Reason: binlog files may contain gtids from being deleted domain '1'; make sure first to purge those files.
PURGE BINARY LOGS TO 'master-bin.000003';;
FLUSH BINARY LOGS DELETE_DOMAIN_ID = (1);
Gtid_list of the current binlog does not contain '1':
show binlog events in 'master-bin.000004' from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
FLUSH BINARY LOGS DELETE_DOMAIN_ID = (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,  0);
ERROR HY000: Could not delete gtid domain. Reason: binlog files may contain gtids from being deleted domain '1'; make sure first to purge those files.
SHOW WARNINGS;
Level	Code	Message
Error	1982	Could not delete gtid domain. Reason: binlog files may contain gtids from being deleted domain '1'; make sure first to purge those files.
FLUSH BINARY LOGS;
PURGE BINARY LOGS TO 'master-bin.000005';
FLUSH BINARY LOGS DELETE_DOMAIN_ID = (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,  0);
Warnings:
Warning	1982	being deleted gtid domain '0' is not in the current binlog state
Gtid_list of the current binlog does not contain 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,  0:
show binlog events in 'master-bin.000006' from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
DROP TABLE t;
